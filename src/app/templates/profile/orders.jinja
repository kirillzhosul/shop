{% extends 'base.jinja' %}

{% block title %}Заказы{% endblock %}

{% block body %}
<div class="container text-center py-5 ">
    <div class="row position-relative">
        <div class="col-lg mx-auto">
            <h1 class="display-4">Заказы</h1>
            <a class="btn btn-primary text-light" href="/catalog">В каталог</a>
        </div>
    </div>
</div>
<div class="container-fluid text-center">
    <div class="row mx-5">
        {% for order in user.orders %}
            <div class="col-lg-4 mb-5" id="order-{{ order.id }}">
                <div class="card">
                    <div class="card-title">
                        <p class="display-4">Заказ №{{ order.id }}</p>
                        <span class="badge badge-dark mb-5">от {{ order.get_date_created() }}</span>
                        <span class="badge badge-dark mb-5">{{ order.get_delivery_type() }}</span>
                        <span class="badge badge-dark mb-5">{{ order.delivery_address }}</span>

                        <h3>
                            <span class="badge badge-{{ order.get_status().get_color() }}">{{ order.get_status() }}</span>
                            <span class="badge badge-dark"> <b>{{ order.get_price() }}₽</b> x <b>{{ order.get_quantity() }}</b><br></span>
                            <p class="mt-1">
                                {% if order.get_status().is_awaiting_payment() %}
                                    <a class="btn btn-outline-success text-dark" href="/">
                                        Оплатить
                                    </a>
                                    <a class="btn btn-outline-danger text-dark" href="/">
                                        Отменить
                                    </a>
                                {% endif %}
                            </p>
                        </h3>
                    </div>

                    <div class="card-body">
                        {% for order_item in order.items %}
                           <a class="btn btn-outline-primary text-dark mb-1" href="/item?id={{ order_item.item_id }}">
                                {{ order_item.item.title|truncate(16, True) }}
                                <b>{{ order_item.price }}₽</b> x <b>{{ order_item.quantity }}</b><br>
                           </a>
                        {% endfor %}<br>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}